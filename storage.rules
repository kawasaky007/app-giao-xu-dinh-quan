rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /{allPaths=**} {
      // Public read access is allowed for all files.
      // This is necessary so that images, documents, etc. can be viewed in the app by anyone.
      allow read: if true;

      // Write operations (create, update, delete) are restricted.
      allow write: if request.auth != null
                   && request.resource.size < 50 * 1024 * 1024 // Max file size of 50MB
                   && (
                     // Allowed Image Types
                     request.resource.contentType.matches('image/jpeg') ||
                     request.resource.contentType.matches('image/png') ||
                     request.resource.contentType.matches('image/gif') ||
                     request.resource.contentType.matches('image/webp') ||

                     // Allowed Video Types
                     request.resource.contentType.matches('video/mp4') ||
                     request.resource.contentType.matches('video/quicktime') ||

                     // Allowed Audio Types
                     request.resource.contentType.matches('audio/mpeg') || // for mp3
                     request.resource.contentType.matches('audio/mp4') ||

                     // Allowed Document Types
                     request.resource.contentType.matches('application/pdf') ||
                     request.resource.contentType.matches('application/msword') || // .doc
                     request.resource.contentType.matches('application/vnd.openxmlformats-officedocument.wordprocessingml.document') || // .docx
                     request.resource.contentType.matches('application/vnd.ms-powerpoint') || // .ppt
                     request.resource.contentType.matches('application/vnd.openxmlformats-officedocument.presentationml.presentation') || // .pptx
                     request.resource.contentType.matches('application/vnd.ms-excel') || // .xls
                     request.resource.contentType.matches('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet') // .xlsx
                   );
    }
  }
}
